---
title: "å…³äº BitTorrent Tracker çš„ä¸€åˆ‡"
subtitle:
date: 2023-01-13T20:26:29+01:00
draft: false
tags: ["BitTorrent"]
categories: ["éšä¾¿å†™ç‚¹ä»€ä¹ˆ"]
image:
description:
---

<!--
![](https://mogeko.github.io/blog-images/r/102/)
{{< spoiler >}}{{< /spoiler >}}
&emsp;&emsp;
 -->

è¿‘æœŸï¼Œæˆ‘å¼€å‘çš„å¼€æºé¡¹ç›® [Yet another BitTorrent Tracker](https://github.com/mogeko/yabtt) è¿æ¥äº† Minimum Viable Product ğŸ‰ã€‚

ç»è¿‡å¯¹ [BitTorrent Enhancement Proposals](http://www.bittorrent.org/beps/bep_0000.html) å°†è¿‘ä¸€ä¸ªæœˆçš„ç ”ç©¶ï¼Œæˆ‘åªèƒ½è¯´ï¼š

![Nobody knows BitTorrent better than me](https://user-images.githubusercontent.com/26341224/212406399-1cfe8fd4-1536-4dfd-a121-489b356b30b3.jpg)

åŒæ—¶ï¼Œæˆ‘è¿˜å‘ç°ï¼›ä¸­æ–‡äº’è”ç½‘ä¸­èƒ½æŠŠ BitTorrent Tracker è®²æ¸…æ¥šçš„æ–‡ç« ç®€ç›´å‡¤æ¯›éºŸè§’ã€‚ä½†è¿™ç©æ„åˆç¡®å®å¾ˆé‡è¦ï¼Œå¾ˆå¤šäººæŠ±æ€¨è‡ªå·±ä½¿ç”¨ BitTorrent ä¸‹ä¸œè¥¿æ²¡æœ‰é€Ÿåº¦å¾ˆå¤§ç¨‹åº¦ä¸Šå°±æ˜¯ BitTorrent Tracker çš„é—®é¢˜ã€‚æ‰€ä»¥å¾ˆæœ‰å¿…è¦å†™ä¸€ç¯‡æ–‡ç« æ¥æŠŠ BitTorrent Tracker çš„å‰ä¸–ä»Šç”Ÿè®²æ¸…æ¥šã€‚

## ä¸“æœ‰åè¯è§£é‡Š

é¦–å…ˆï¼Œä¸ºäº†è¡Œæ–‡æ–¹ä¾¿ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰å‡ ä¸ªä¸“æœ‰åè¯ï¼š

- BT: åŠ BitTorrentï¼Œä¸€ç§å»ä¸­å¿ƒåŒ–æ–‡ä»¶åˆ†äº«åè®®
- Peer: ä½¿ç”¨ BitTorrent è¿›è¡Œäº¤æ¢æ•°æ®çš„å®¢æˆ·ç«¯

## BitTorrent Tracker æ˜¯ä»€ä¹ˆï¼Ÿ

ç®€å•æ¥è®²ï¼ŒBitTorrent Tracker æ˜¯ä¸€ä¸ªå“åº” HTTP GET è¯·æ±‚çš„ HTTP/HTTPS æœåŠ¡å™¨ã€‚

## BitTorrent Tracker æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ

å½“ä¸€ä¸ª Peer éœ€è¦é€šè¿‡ BT ä¸‹è½½ã€Œæ–‡ä»¶ Aã€æ—¶ï¼Œå®ƒä¼šå°†ã€Œæ–‡ä»¶ Aã€çš„ç‰¹å¾ç  ([SHA-1](https://zh.wikipedia.org/wiki/SHA-1))ã€Peer çš„ ID ç­‰å…ƒä¿¡æ¯é€šè¿‡ [GET æ–¹æ³•](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/GET)å‘é€ç»™ Trackerã€‚

```shell
curl 'http://example.com/announce?info_hash=%124Vx%9A%BC%DE%F1%23Eg%89%AB%CD%EF%124Vx%9A&peer_id=00000000000000000001...'
```

{{< notice info "Notice" >}}
`info_hash` æ˜¯ä¸€æ®µ 20-byte é•¿çš„äºŒè¿›åˆ¶ SHA-1ï¼Œä¸ºäº†ä¼ è¾“å®‰å…¨ï¼Œå®ƒéœ€è¦è¢«ç¼–ç ä¸º [RFC1738](http://www.faqs.org/rfcs/rfc1738.html)ã€‚

ä¾‹å¦‚ï¼Œå¯¹äºè¿™ä¸ª SHA-1: `\x12\x34\x56\x78\x9a\xbc\xde\xf1\x23\x45\x67\x89\xab\xcd\xef\x12\x34\x56\x78\x9a`

å®ƒå°†ä¼šè¢«ç¼–ç ä¸ºï¼š`%124Vx%9A%BC%DE%F1%23Eg%89%AB%CD%EF%124Vx%9A`

{{< /notice >}}

Tracker ä¼šå°†å…¶è®°å½•ä¸‹æ¥ï¼Œå¹¶è¿”å›å®ƒè®°å½•çš„ä¸ã€Œæ–‡ä»¶ Aã€ç›¸å…³çš„ Peer ç»„æˆçš„åˆ—è¡¨ (å¤§çº¦ 50 ä¸ª)ã€‚

```json
{
  "interval": 3600,
  "peers": [
    { "ip": "1.2.3.3", "peer id": "00000000000000000003", "port": 8000 },
    { "ip": "1.2.3.1", "peer id": "00000000000000000001", "port": 8000 },
    { "ip": "1.2.3.4", "peer id": "00000000000000000004", "port": 8000 },
    { "ip": "1.2.3.2", "peer id": "00000000000000000002", "port": 8000 },
    { "ip": "1.2.3.5", "peer id": "00000000000000000005", "port": 8000 }
    // ...
  ]
}
```

ç„¶åä½ å°±å¯ä»¥å’Œåˆ«çš„ Peer è¿›è¡Œæ•°æ®äº¤æ¢äº†ã€‚

ä½ å¯ä»¥é€šè¿‡ Tracker æ‰¾åˆ°åˆ«çš„ Peerï¼Œè€Œåˆ«çš„ Peer ä¹Ÿå¯ä»¥é€šè¿‡å®ƒæ‰¾åˆ°ä½ ï¼Œè¿™å°±æ˜¯ Tracker çš„ä½œç”¨ã€‚

## é™åˆ¶ä¸è¡¥æ•‘æªæ–½

è™½ç„¶ BT ä¸‹è½½æœ¬èº«æ˜¯å»ä¸­å¿ƒåŒ–çš„ï¼Œä½† BitTorrent Tracker æœåŠ¡å™¨ä¸æ˜¯ï¼›æ‰€ä»¥å®ƒå¾ˆå®¹æ˜“è¢«ç›‘ç®¡æœºæ„ç›¯ä¸Šã€‚å¾ˆå¤šäººæŠ±æ€¨è‡ªå·±ä½¿ç”¨ BT ä¸‹è½½çƒ­é—¨èµ„æºå´æ²¡æœ‰é€Ÿåº¦ï¼Œå¾ˆå¤šæƒ…å†µä¸‹å°±æ˜¯å› ä¸º Tracker è¢« BAN äº†ã€‚

è§£å†³åŠæ³•å°±æ˜¯**å®šæœŸæ›´æ–° Tracker æœåŠ¡å™¨çš„åˆ—è¡¨**ï¼›ä¸»æµçš„ BT å®¢æˆ·ç«¯éƒ½å…è®¸æˆ‘ä»¬æ‰‹åŠ¨æ·»åŠ /æ›´æ–°é¢å¤–çš„ Tracker æœåŠ¡å™¨ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½æ˜¯åœ¨è®¾ç½®é‡Œï¼Œå¤åˆ¶ç²˜è´´ä½ æƒ³è¦æ·»åŠ çš„ Tracker æœåŠ¡å™¨çš„åœ°å€å°±å¯ä»¥äº†ï¼Œä¹Ÿæœ‰å°‘æ•°éœ€è¦é’ˆå¯¹æ¯ä¸€ä¸ªä¸‹è½½ä»»åŠ¡å•ç‹¬æ·»åŠ ã€‚è‡³äºåˆ°å“ªå„¿æ‰¾ Tracker æœåŠ¡å™¨åœ°å€ï¼ŸGitHub ä¸Šä¸“é—¨æœ‰ä¸ªé¡¹ç›®æ”¶é›†å½“å‰æ´»è·ƒçš„ Tracker: [ngosang/trackerslist](https://github.com/ngosang/trackerslist)ï¼Œæ¯æ—¥æ›´æ–°ã€‚

åŒæ—¶ï¼Œç›®å‰ä¸»æµçš„ BT å®¢æˆ·ç«¯éƒ½å®ç°äº† [Peer Exchange (PEX) åè®®](http://www.bittorrent.org/beps/bep_0011.html)ï¼Œå®ƒå…è®¸ Peer ä¹‹é—´åˆ†äº«ä»–ä»¬è®°å½•çš„åˆ«çš„ Peer çš„ä¿¡æ¯ã€‚ç„¶åé€šè¿‡è¿™ç§ P2P2P2P... çš„æ–¹å¼å®Œå…¨å»ä¸­å¿ƒåŒ–çš„ç»„æˆ Peer ç½‘ç»œã€‚æœ‰äº† PEX ä½œä¸ºè¡¥å……ï¼ŒTracker ä½œç”¨å°±æ˜¾å¾—ä¸é‚£ä¹ˆé‡è¦äº†ï¼›ä¸€èˆ¬ Tracker åªåœ¨ç¬¬ä¸€æ¬¡ä¸‹è½½æ—¶ä½¿ç”¨ï¼Œä¿—ç§°â€œç‚¹ç«â€ã€‚ç„¶åç­‰ä½ æ‰¾åˆ°è‡³å°‘ä¸€ä¸ªåˆ«çš„ Peer åï¼Œå°±å¯ä»¥é€šè¿‡ PEX åè®®æ‰¾åˆ°æ›´å¤šçš„ Peerï¼›Peer è¶Šå¤šï¼Œä¸‹è½½å°±è¶Šå¿«ã€‚
